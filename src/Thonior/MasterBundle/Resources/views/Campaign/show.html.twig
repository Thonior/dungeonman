{% extends 'ThoniorMasterBundle::base.html.twig' %}

{% block body -%}
    <h1>Campaign</h1>
    <div id="votes">
        {{ form_start(rate_form, {'attr':{'id' : 'rateform'} }) }}
        {{ form_errors(rate_form) }}
        {{ form_end(rate_form) }}
    </div>
    (based on {{entity.rates}} votes)
    <table class="record_properties">
        <tbody>
            <tr>
                <th>Title</th>
                <td>{{ entity.title }}</td>
            </tr>
            <tr>
                <th>Rating</th>
                <td>{{ entity.rating }}</td>
            </tr>
            <tr>
                <th>Introduction</th>
                <td>{{ entity.introduction }}</td>
            </tr>
        </tbody>
    </table>

        <ul class="record_actions">
    <li>
        <a class="manager" data-path="{{ path('campaign') }}" href="#campaign">
            Back to the list
        </a>
    </li>
    <li>
        <a href="{{ path('campaign_edit', { 'id': entity.id }) }}">
            Edit
        </a>
    </li>
    <li>{{ form(delete_form) }}</li>
</ul>
<script>
    $(document).ready(function(){
        $('.rating-well div').click(function(){
            var value = $(this).data('value');
            $.post("{{path('campaign_rate')}}", {'id': "{{entity.id}}",'stars':value})
                    .done(function(data){
                        setCookie('voted_campaign_{{entity.id}}',value,1000);
                    });
        });
    });
</script>
{% endblock %}
